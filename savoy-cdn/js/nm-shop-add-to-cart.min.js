/* NM: Add-to-cart script */
(function(c){c.extend(c.nmTheme,{atc_init:function(){this.atcBind()},atcBind:function(){var d=this;d.$body.on("click",".single_add_to_cart_button",function(a){var b=c(this);if(b.is(".disabled"))console.log("NM: Add-to-cart button disabled");else if(b.hasClass("nm-simple-add-to-cart-button")||b.hasClass("nm-variable-add-to-cart-button"))a.preventDefault(),d.quickviewOpen=d.quickviewIsOpen(),d.quickviewOpen&&b.addClass("nm-loader nm-loader-light"),b.attr("disabled","disabled"),a=b.closest("form"),a.length&&
(a={product_id:a.find("[name*='add-to-cart']").val(),product_variation_data:a.serialize()},d.$body.trigger("adding_to_cart",[b,a]),d.atcAjaxSubmitForm(b,a))})},atcAjaxSubmitForm:function(d,a){var b=this;if(a.product_id){if("undefined"!==typeof wc_add_to_cart_params)var e=wc_add_to_cart_params.wc_ajax_url;else console.log('NM: "wc_add_to_cart_params" undefined - WooCommerce AJAX atc disabled'),e=nm_wp_vars.woocommerceAjaxUrl;e=e.toString().replace("wc-ajax=%%endpoint%%","add-to-cart="+a.product_id+
"&nm-ajax-add-to-cart=1");c.ajax({type:"POST",url:e,data:a.product_variation_data,dataType:"html",cache:!1,headers:{"cache-control":"no-cache"},error:function(b,a,c){console.log("NM: AJAX error - atcAjaxSubmitForm() - "+c)},success:function(a){a=c("<div>"+a+"</div>");var f=a.find("#nm-shop-notices-wrap"),e=f.find(".woocommerce-error").length?!0:!1;f={".nm-menu-cart-count":a.find(".nm-menu-cart-count").prop("outerHTML"),"#nm-shop-notices-wrap":f.prop("outerHTML"),"#nm-cart-panel":a.find("#nm-cart-panel").prop("outerHTML")};
b.shopReplaceFragments(f);b.$body.trigger("added_to_cart",[f,""]);b.quickviewOpen?(c.magnificPopup.close(),e?b.isShop&&b.shopScrollToTop():b.$widgetPanel.length&&setTimeout(function(){b.widgetPanelShow(!1,!0)},350)):(d.removeAttr("disabled"),e&&setTimeout(function(){c("#nm-widget-panel-overlay").trigger("click");b.isShop&&b.shopScrollToTop()},500));a.empty()}})}else console.log("NM (Error): No product id found")}});c.nmThemeExtensions.add_to_cart=c.nmTheme.atc_init})(jQuery);