/* NM: Shop script */
(function(b){b.extend(b.nmTheme,{shop_init:function(){var a=this;a.shopSelectConfig={onOpen:function(){var c=b(this);c.closest("tr").addClass("open");var e=c.closest("tr")[0].getBoundingClientRect().width;c.children(".sod_list_wrapper").css("width",e+"px");c.children("select").trigger("focusin")},onChange:function(){b(this).closest("tr").removeClass("open")},onClose:function(){b(this).closest("tr").removeClass("open")}};if(a.isShop){a.shopAjax=!1;a.scrollOffsetDesktop=parseInt(nm_wp_vars.shopScrollOffset);
a.scrollOffsetTablet=parseInt(nm_wp_vars.shopScrollOffsetTablet);a.scrollOffsetMobile=parseInt(nm_wp_vars.shopScrollOffsetMobile);a.infloadScroll=!1;a.categoryClicked=!1;a.shopLoaderSpeed=300;a.shopScrollSpeed=410;a.$shopBrowseWrap=b("#nm-shop-browse-wrap");a.imageLazyLoading="0"!=nm_wp_vars.shopImageLazyLoad?!0:!1;a.filtersEnableAjax="0"!=nm_wp_vars.shopFiltersAjax?a.isTouch&&"1"!=nm_wp_vars.shopFiltersAjax?!1:!0:!1;a.shopSetScrollOffset();a.shopSetMinHeight();var d=null;a.$window.resize(function(){d&&
clearTimeout(d);d=setTimeout(function(){a.shopSetMinHeight();a.shopSetScrollOffset()},250)});if(a.$pageIncludes.hasClass("banner-slider"))a.$document.on("banner-slider-loaded",function(){a.shopUrlHashScroll()});else a.shopUrlHashScroll();a.imageLazyLoading&&setTimeout(function(){a.$shopWrap.addClass("images-show")},50);if(a.filtersEnableAjax)a.$window.on("popstate.nmshop",function(c){c.originalEvent.state&&c.originalEvent.state.nmShop&&a.shopGetPage(window.location.href,!0)});b("#nm-main-menu-ul").children(".shop-link").find("> a").bind("click",
function(c){c.preventDefault();a.shopScrollToTop()});a.$shopWrap.on("click.nmShopFiltersReset","#nm-shop-filters-reset",function(c){c.preventDefault();a.shopFiltersReset(this)});a.$shopWrap.on("click.nmShopSearchTaxonomyReset","#nm-shop-search-taxonomy-reset",function(c){c.preventDefault();a.shopSearchTaxonomyReset(this)})}a.$document.on("woocommerce_update_variation_values",".variations_form",function(){a.singleProductVariationsUpdate()});"undefined"!==typeof wc_add_to_cart_params&&"yes"!==wc_add_to_cart_params.cart_redirect_after_add?
(a.$body.on("adding_to_cart",function(c,e,f){a.$widgetPanel.length?a.quickviewIsOpen()||a.widgetPanelShow(!0,!0):(a.$pageOverlay.addClass("nm-loader"),a.pageOverlayShow())}),a.$body.on("added_to_cart",function(c,e,f){a.$widgetPanel.length?a.quickviewIsOpen()||a.widgetPanelCartHideLoader():(a.pageOverlayHide(),a.$pageOverlay.removeClass("nm-loader"))})):a.$document.off("click",".add_to_cart_button");a.shopLoadExtension()},shopLoadExtension:function(){b.nmThemeExtensions.add_to_cart&&b.nmThemeExtensions.add_to_cart.call(this);
this.isShop&&(b.nmThemeExtensions.infload&&b.nmThemeExtensions.infload.call(this),b.nmThemeExtensions.filters&&b.nmThemeExtensions.filters.call(this));this.$pageIncludes.hasClass("quickview")&&b.nmThemeExtensions.quickview&&b.nmThemeExtensions.quickview.call(this)},shopUrlHashScroll:function(){"#shop"===window.location.hash&&this.shopScrollToTop(!0)},shopCheckVariationDetails:function(a){var d=a.children(),c=!0;if(d.length)for(var e=0;e<d.length;e++)if(d.eq(e).children().length){c=!1;break}c?a.hide():
a.show()},shopSetScrollOffset:function(){var a=this.$body.width();this.scrollOffset=863<a?this.$header.hasClass("static-on-scroll")?this.$header.outerHeight():this.scrollOffsetDesktop:383<a?this.scrollOffsetTablet:this.scrollOffsetMobile},shopSetMinHeight:function(){var a=b("#nm-footer").outerHeight(!0);this.$shopWrap.css("min-height",this.$window.height()-(a+this.scrollOffset)+"px")},shopScrollToTop:function(a,d){var c=0,e=399<this.$window.width()?Math.round(this.$shopWrap.offset().top-this.scrollOffset):
Math.round(b("#nm-shop-products").offset().top-24-this.scrollOffset);if(50>Math.abs(e-this.$html.scrollTop()))return c;a&&this.shopSetMinHeight();d?b("html, body").scrollTop(e):(c=this.shopScrollSpeed,b("html, body").animate({scrollTop:e},this.shopScrollSpeed));return c},shopShowNotices:function(){this.$body.addClass("nm-woocommerce-message-show");this.isShop&&"0"!=nm_wp_vars.cartPanelHideOnAtcScroll&&this.shopScrollToTop()},shopRemoveNotices:function(){b("#nm-shop-notices-wrap").empty()},shopShowLoader:function(a){var d=
b("#nm-shop-products-overlay");a&&d.addClass("no-anim");d.addClass("show");this.$shopWrap.addClass("loading")},shopHideLoader:function(a){var d=b("#nm-shop-products-overlay");a||d.removeClass("no-anim");d.removeClass("nm-loader").addClass("fade-out");setTimeout(function(){d.removeClass("show fade-out").addClass("nm-loader")},this.shopLoaderSpeed);this.infloadScroll&&(this.infscrollLock=!1,this.$window.trigger("scroll"));this.$shopWrap.removeClass("loading")},shopFiltersReset:function(a){a=b(a);a=
a.data("shop-override-url")?a.data("shop-override-url"):location.href.replace(location.search,"");this.filtersEnableAjax?this.shopGetPage(a):window.location.href=a},shopSearchTaxonomyReset:function(a){a=b(a);a=a.closest(".nm-shop-results-bar").hasClass("is-search")?this.urlGetParameter("s")?a.data("shop-url"):location.href.replace(location.search,""):a.data("shop-url");this.filtersEnableAjax?this.shopGetPage(a):window.location.href=a},singleProductVariationsInit:function(a){var d=this,c=a.children(".variations"),
e=a.children(".single_variation_wrap").children(".single_variation");if(d.shopCustomSelect){a=c.find("select");for(var f,g=0;g<a.length;g++)f=a.eq(g),f.parent().hasClass("nm-select-hidden")||f.selectOrDie(d.shopSelectConfig)}var h=null;c.find(".nm-variation-control").children("li").bind("click",function(){if(!h){var k=b(this),l=k.parent(),m=l.parent().children(".nm-select-hidden").find("select"),n=k.data("value");k.hasClass("selected")?(k.removeClass("selected"),m.val("").trigger("change")):(l.children(".selected").removeClass("selected"),
k.addClass("selected"),m.val(n).trigger("change"));h=setTimeout(function(){h=null},300)}});d.shopCheckVariationDetails(e);e.on("show_variation",function(){d.shopCheckVariationDetails(b(this))});e.on("hide_variation",function(){e.css("display","none")})},singleProductVariationsUpdate:function(){var a=this;b(".variations_form").find("select").each(function(){var d=b(this);a.shopCustomSelect&&d.selectOrDie("update");if(d.parent(".nm-select-hidden").length)for(var c=d.closest(".value").children(".nm-variation-control").children("li"),
e,f,g,h=0;h<c.length;h++)e=b(c[h]),f=e.data("value"),f=d.children('[value="'+f+'"]'),f.length?(g=f.attr("disabled"),f.hasClass("enabled")?e.removeClass("hidden disabled"):"undefined"!==typeof g&&!1!==g&&e.removeClass("hidden").addClass("disabled")):e.removeClass("disabled").addClass("hidden")})},quickviewIsOpen:function(){return b("#nm-quickview").is(":visible")}});b.nmThemeExtensions.shop=b.nmTheme.shop_init})(jQuery);