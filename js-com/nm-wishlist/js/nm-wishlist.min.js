/* NM Wishlist */
(function(c){var g={init:function(){var a=this;if("undefined"!=typeof nm_wp_vars){a.$body=c("body");a.isLoggedIn=a.$body.hasClass("logged-in")?!0:!1;a.wishlistIds=[];a.cookieExpires=parseInt(nm_wishlist_vars.wlCookieExpires);a.IDsUpdateAjax=!1;"0"!=nm_wishlist_vars.wlMenuCount?(a.headerLinkCount=!0,a.$headerLinkLi=c(".nm-menu-wishlist"),a.$headerLinkCount=a.$headerLinkLi.find(".nm-menu-wishlist-count")):a.headerLinkCount=!1;a.setUp();c(document).on("click",".nm-wishlist-button",function(b){b.preventDefault();
a.IDsUpdateAjax&&(a.IDsUpdateAjax.abort(),a.IDsUpdateAjax=!1);a.buttonToggle(this)});var d=c("#nm-wishlist-table");d.length&&d.find(".nm-wishlist-remove").bind("click",function(b){b.preventDefault();b=c(this);b.hasClass("clicked")||(b.addClass("clicked"),a.wishlistItemRemove(b,d))})}},setUp:function(){var a=this;if(a.isLoggedIn)c.ajax({type:"POST",url:nm_wp_vars.ajaxUrl,data:{action:"nm_wishlist_get_ids"},dataType:"json",cache:!1,headers:{"cache-control":"no-cache"},success:function(b){b.ids&&(b=
b.ids,a.wishlistIds=b,Cookies.set("nm-wishlist-ids",b,{expires:a.cookieExpires}),a.headerLinkUpdate(),a.buttonsSetState())}});else{var d=Cookies.getJSON("nm-wishlist-ids");d?(a.wishlistIds=d,a.headerLinkUpdate(),a.buttonsSetState()):Cookies.set("nm-wishlist-ids",[],{expires:a.cookieExpires})}},IDsUpdate:function(){var a=this;if(a.isLoggedIn){var d=JSON.stringify(a.wishlistIds);a.IDsUpdateAjax=c.ajax({type:"POST",url:nm_wp_vars.ajaxUrl,data:{action:"nm_wishlist_update_ids",nonce:nm_wishlist_vars.wlNonce,
ids:d},dataType:"json",cache:!1,headers:{"cache-control":"no-cache"},complete:function(){a.IDsUpdateAjax=!1}})}Cookies.set("nm-wishlist-ids",a.wishlistIds,{expires:a.cookieExpires})},buttonsSetState:function(){for(var a=0;a<this.wishlistIds.length;a++)c("#nm-wishlist-item-"+this.wishlistIds[a]+"-button").addClass("added");this.$body.addClass("wishlist-show-buttons")},buttonSetState:function(a,d){var b=c(".nm-wishlist-item-"+a+"-button");d?(b.addClass("added"),b.attr("title",nm_wishlist_vars.wlButtonTitleRemove),
this.$body.trigger("wishlist_added_item")):(b.removeClass("added"),b.attr("title",nm_wishlist_vars.wlButtonTitleAdd),this.$body.trigger("wishlist_removed_item"))},buttonToggle:function(a){a=c(a).data("product-id");var d=!0,b=c.inArray(a,this.wishlistIds);-1==b?this.wishlistIds.unshift(a):(this.wishlistIds.splice(b,1),d=!1);this.IDsUpdate();this.headerLinkUpdate();this.buttonSetState(a,d)},wishlistItemRemove:function(a,d){c("#nm-wishlist-overlay").addClass("show");var b=this,f=a.closest("ul"),e=f.data("product-id");
f.addClass("removing");e=c.inArray(e,b.wishlistIds);-1!=e&&b.wishlistIds.splice(e,1);b.IDsUpdate();b.headerLinkUpdate();setTimeout(function(){f.remove();b.$body.trigger("wishlist_removed_item");0==d.children("ul").length&&(c("#nm-wishlist").css("display","none"),c("#nm-wishlist-empty").addClass("show"));c("#nm-wishlist-overlay").removeClass("show")},500)},headerLinkUpdate:function(){this.headerLinkCount&&(this.wishlistIds.length?(this.$headerLinkLi.addClass("has-items"),this.$headerLinkCount.text(this.wishlistIds.length)):
(this.$headerLinkLi.removeClass("has-items"),this.$headerLinkCount.text("0")))}};c(document).ready(function(){g.init()})})(jQuery);